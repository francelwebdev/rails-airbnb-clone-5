<div class="container">
  <div class="row">
  <% user_avatar_url = @user.facebook_picture_url || @user.photo %>

    <h2><%= image_tag user_avatar_url, crop: :fill, class: "avatar" %> <%= @user.first_name %></h2>
    <div class="col-xs-12 col-sm-6">
      <div>
        <h3>Places</h3>
        <% @places.each do |place| %>
        <div class="card text-center">


          <div class="card-header" style="background-image: url('<%= cl_image_path place.photo, height: 300, width: 400, crop: :fill %>')">
          </div>


          <div class="card-description">
            <h3><%= place.name %></h3>
          </div>
          <%= link_to "", place_path(place), class: "card-link" %>
        </div>
        <% end %>
      </div>
    </div>
    <div class="col-xs-12 col-sm-6">
      <% if current_user == @user %>
      <ul class="nav nav-tabs" role="tablist">
      <li role="presentation" class="active"><a href="#guests" data-toggle="tab">My guests</a>
        </li>
        <li role="presentation"><a href="#bookings"  data-toggle="tab">My bookings</a>
        </li>
      </ul>
      <div class="tab-content">
        <div role="tabpanel" class="tab-pane active" id="guests">
          <table class="table">
            <tr>
              <th>Guest</th>
              <th>Place</th>
              <th>Status</th>
            </tr>
            <% @reservations_for_me.each do |res| %>
            <tr>
              <td>
                <%= link_to res.user.first_name, user_path(res.user) %>
              </td>
              <td>
               <%= link_to res.place.name, place_path(res.place) %>
             </td>
             <td>
              <% if res.status == "pending" %>
              <%= link_to "Accept", reservation_accept_path(res.id), method: :patch, class: "btn btn-success btn-xs" %> <%= link_to "Decline", reservation_decline_path(res.id), method: :patch, class: "btn btn-danger btn-xs" %>
              <% elsif res.status == "accepted" %>
              <span class="label label-success"><i class="fa fa-check"></i></span> Accepted
              <% elsif res.status == "declined" %>
              <span class="label label-danger"><i class="fa fa-times"></i></span> Declined
              <% end %>
            </td>
          </tr>
          <% end %>
        </table>
      </div>
      <div role="tabpanel" class="tab-pane" id="bookings">
        <table class="table">
          <tr>
            <th>Place</th>
            <th>Host</th>
            <th>Status</th>
          </tr>
          <% @reservations_i_made.each do |res| %>
          <tr>
            <td>
              <%= link_to res.place.name, place_path(res.place) %>
            </td>
            <td>
              <%= link_to res.place.user.first_name, user_path(res.place.user) %>
            </td>
            <td>
              <% if res.status == "accepted" %>
              <span class="label label-success"><i class="fa fa-check"></i></span> Accepted
              <% elsif res.status == "declined" %>
              <span class="label label-danger"><i class="fa fa-times"></i></span> Declined
              <% else %>
              <span class="label label-default"><i class="fa fa-question"></i></span> Pending
              <% end %>
            </td>
          </tr>
          <% end %>
        </table>
      </div>
    </div>




    <% end %>
  </div>
</div>
</div>
